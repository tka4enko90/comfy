!function(e,a){var r;AW.Validate={errorMessages:{},init:function(){setInterval((function(){"undefined"!=typeof tinyMCE&&tinyMCE.triggerSave(),e(".automatewoo-field-wrap textarea.wp-editor-area").each((function(){e(this).attr("data-automatewoo-validate","variables"),r.validateField(e(this))}))}),2e3),e(document.body).on("keyup blur change","[data-automatewoo-validate]",(function(a){r.validateField(e(a.target))})),r.validateAllFields()},validateAllFields:function(){e("[data-automatewoo-validate]").each((function(){r.validateField(e(this))}))},validateField:function(e){if(AW.workflow){var a=[],t=e.val();r.clearFieldErrors(e);var i=AW.Validate.getVariablesFromText(t);if(r.fieldSupports("variables",e)){var o=AW.workflow.get("trigger");_.each(i,(function(e){var t=r.isVariableValidForTrigger(e,o);!0!==t&&a.push(r.getErrorMessage(t,r.getVariableWithoutParams(e)))}))}else i&&a.push(r.getErrorMessage("noVariablesSupport"));a.length&&r.setFieldErrors(e,a)}},setFieldErrors:function(e,a){e.addClass("automatewoo-field--invalid");var r=e.parents(".automatewoo-field-wrap:first");r.append('<div class="automatewoo-field-errors"></div>');var t=r.find(".automatewoo-field-errors");e.is(".wp-editor-area")&&r.find(".wp-editor-container").addClass("automatewoo-field--invalid"),_.each(a,(function(e){t.append('<div class="automatewoo-field-errors__error">'+e+"</div>")}))},clearFieldErrors:function(e){var a=e.parents(".automatewoo-field-wrap:first");e.removeClass("automatewoo-field--invalid"),e.is(".wp-editor-area")&&a.find(".wp-editor-container").removeClass("automatewoo-field--invalid"),a.find(".automatewoo-field-errors").remove()},fieldSupports:function(e,a){var r=a.data("automatewoo-validate").split(" ");return-1!==_.indexOf(r,e)},isVariableValidForTrigger:function(e,a){var t=r.getDataTypeFromVariable(e),i=r.getDataFieldFromVariable(e);if(t&&-1===_.indexOf(a.supplied_data_items,t))return"invalidDataType";var o=AW.workflow.get("variables");return!o||!o[t]||-1!==o[t].indexOf(i)||"invalidVariable"},getVariablesFromText:function(e){var a=e.match(/{{(.*?)}}/g);return!!a&&(_.each(a,(function(e,r){a[r]=e.replace(/{|}/g,"").trim()})),a)},getVariableWithoutParams:function(e){return e.replace(/(\|.*)/,"")},getDataTypeFromVariable:function(e){return-1!==e.indexOf(".")&&e.replace(/(\..*)/,"")},getDataFieldFromVariable:function(e){var a=(e=r.getVariableWithoutParams(e)).indexOf(".");return-1!==a&&e.substring(a+1).trim()},getErrorMessage:function(e,a){if(!r.errorMessages[e])return"Unknown error, please try refreshing your browser.";var t=r.errorMessages[e];return"string"==typeof a&&(t=t.replace("%s",a)),t}},(r=AW.Validate).errorMessages=a}(jQuery,automatewooValidateLocalizedErrorMessages);
//# sourceMappingURL=validate.min.js.map
